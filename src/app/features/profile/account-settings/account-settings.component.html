<div [formGroup]="profileForm" class="bg-[#121212] border border-white/5 rounded-2xl p-5 mb-6 shadow-lg">
  <div class="flex flex-col md:flex-row gap-8"> <div class="flex flex-col items-center md:w-1/3">
    <div class="relative mb-4"> <div class="w-24 h-24 rounded-full border-4 border-vortex-purple bg-zinc-800 flex items-center justify-center overflow-hidden shadow-[0_0_20px_rgba(147,51,234,0.3)]">
      @if (currentUser()?.avatar_url) {
        <img [src]="currentUser()?.avatar_url" class="w-full h-full object-cover" alt="">
      } @else {
        <span class="text-3xl text-zinc-600">üë§</span>
      }
    </div>
    </div>

    <div class="w-full space-y-1"> <label class="text-[10px] font-bold text-gray-500 uppercase tracking-widest block text-center">Nickname P√∫blico</label>
      <div class="bg-[#0D0D0D] border border-white/10 rounded-lg px-3 py-2 flex justify-between items-center group transition-colors focus-within:border-vortex-purple">
        <input
          formControlName="internal_nick"
          type="text"
          class="bg-transparent text-white font-medium focus:outline-none w-full text-center tracking-wide placeholder-gray-700 text-sm"
          placeholder="TuNick_Vortex">
        <span class="text-gray-500 text-xs">‚úèÔ∏è</span>
      </div>
      @if (profileForm.get('internal_nick')?.invalid && profileForm.get('internal_nick')?.touched) {
        <small class="text-red-500 text-[10px] block text-center">M√≠nimo 3 caracteres alfanum√©ricos.</small>
      }
    </div>
  </div>

    <div class="flex-1 flex flex-col justify-between">
      <div>
        <h2 class="text-lg font-bold text-white mb-4 border-b border-white/5 pb-2">Configuraci√≥n de la Cuenta</h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-2"> <div class="space-y-1">
          <label class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Pa√≠s</label>
          <div class="relative">
            <select
              formControlName="country"
              (change)="onCountryChange($event)"
              class="w-full bg-[#0D0D0D] border border-white/10 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-vortex-cyan appearance-none cursor-pointer">
              <option value="" disabled selected>Selecciona tu pa√≠s</option>
              @for (country of countries; track country.code) {
                <option [value]="country.code">{{ country.name }} ({{ country.dial_code }})</option>
              }
            </select>
            <span class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-gray-500 text-xs">‚ñº</span>
          </div>
        </div>

          <div class="space-y-1">
            <label class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Discord ID</label>
            <div class="relative">
              <span class="absolute left-3 top-1/2 -translate-y-1/2 text-[#5865F2]">
                <i class="pi pi-discord text-sm"></i>
              </span>
              <input
                formControlName="discord_id"
                type="text"
                placeholder="usuario#1234"
                class="w-full bg-[#0D0D0D] border border-white/10 rounded-lg pl-9 pr-3 py-2 text-white text-sm focus:outline-none focus:border-[#5865F2] placeholder-gray-700 transition-colors">
            </div>
          </div>

          <div class="md:col-span-2 space-y-1">
            <label class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">WhatsApp</label>
            <div class="flex gap-2">
              <div class="w-17.5">
                <input
                  formControlName="phone_country_code"
                  type="text"
                  readonly
                  class="w-full bg-[#1a1a1a] border border-white/5 rounded-lg px-2 py-2 text-gray-400 text-center text-sm focus:outline-none cursor-not-allowed">
              </div>

              <div class="flex-1">
                <input
                  formControlName="phone_number"
                  type="text"
                  placeholder="999 888 777"
                  class="w-full bg-[#0D0D0D] border border-white/10 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-green-500 placeholder-gray-700 transition-colors">
              </div>
            </div>
            @if (profileForm.get('phone_number')?.invalid && profileForm.get('phone_number')?.touched) {
              <small class="text-red-500 text-[10px]">Ingresa solo n√∫meros v√°lidos.</small>
            }
          </div>

        </div>
      </div>

      <div class="flex items-center justify-end gap-4 mt-4 pt-4 border-t border-white/5">
        <button
          (click)="saveChanges()"
          [disabled]="isLoading() || profileForm.invalid || !hasChanges"
          class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-lg font-bold text-sm transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-[0_0_15px_rgba(37,99,235,0.3)] hover:shadow-[0_0_25px_rgba(37,99,235,0.5)] active:scale-95"
        >
          @if (isLoading()) {
            <div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
            <span>Guardando...</span>
          } @else {
            <i class="pi pi-check text-sm font-bold"></i>
            <span>Guardar Cambios</span>
          }
        </button>
      </div>
    </div>
  </div>
</div>
